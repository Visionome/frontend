import{c as N,r as x,j as e,B as G,L as D,u as M,C as g,a as C,b as B,d as k,e as E,f as L}from"./index-DxfdLjFq.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=N("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=N("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=N("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=N("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),q="ATGGATTTATCTGCTCTTCGCGTTGAAGAAGTACAAAATGTCATTAATGCTATGCAGAAAATCTTAGAGTGTCCCATCTGTCTGGAGTTGATCAAGGAACCTGTCTCCACAAAGTGTGACCACATATTTTGCAAATTTTGCATGCTGAAACTTCTCAACCAGAAGAAAGGGCCTTCACAGTGTCCTTTATGTAAGAATGATATAACCAAAAGGAGCCTACAAGAAAGTACGAGATTTAGTCAACTTGTTGAAGAGCTATTGAAAATCATTTGTGCTTTTCAGCTTGACACAGGTTTGGAGTATGCAAACAGCTATAATTTTGCAAAAAAGGAAAATAACTCTCCTGAACATCTAAAAGATGAAGTTTCTATCATCCAAAGTATGGGCTACAGAAACCGTGCCAAAAGACTTCTACAGAGTGAACCCGAAAATCCTTCCTTG";function H({sequence:n,onSequenceChange:t,onRun:a,onClear:s,isLoading:r}){const l=x.useRef(null);function i(c){var b;const T=(b=c.target.files)==null?void 0:b[0];if(!T)return;const d=new FileReader;d.onload=_=>{var h;const A=(h=_.target)==null?void 0:h.result;if(typeof A=="string"){const p=A.split(`
`).filter(f=>!f.startsWith(">"));t(p.join("").trim())}},d.readAsText(T),c.target.value=""}return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium",children:"DNA Sequence"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(G,{variant:"ghost",size:"sm",onClick:()=>t(q),className:"text-xs",children:[e.jsx(R,{className:"mr-1 h-3 w-3"}),"Example"]}),e.jsxs(G,{variant:"ghost",size:"sm",onClick:()=>{var c;return(c=l.current)==null?void 0:c.click()},children:[e.jsx(O,{className:"mr-1 h-3 w-3"}),"Upload"]}),e.jsx("input",{ref:l,type:"file",accept:".fasta,.fa,.txt",className:"hidden",onChange:i})]})]}),e.jsx("textarea",{value:n,onChange:c=>t(c.target.value),placeholder:"Paste a DNA sequence here (ATCG)...",rows:6,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm font-mono ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 resize-y"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(G,{onClick:a,disabled:!n.trim()||r,children:[r?e.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(I,{className:"mr-2 h-4 w-4"}),r?"Running...":"Run BLAST"]}),e.jsxs(G,{variant:"outline",onClick:s,disabled:r,children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Clear"]})]})]})}function U({matches:n,metadata:t}){const a=M();return n.length===0?null:e.jsxs("div",{className:"space-y-4",children:[t&&e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(g,{className:"flex-1 min-w-[140px]",children:e.jsxs(C,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:t.total_hits}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Hits"})]})}),e.jsx(g,{className:"flex-1 min-w-[140px]",children:e.jsxs(C,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:t.best_gene_symbol}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Best Match"})]})}),e.jsx(g,{className:"flex-1 min-w-[140px]",children:e.jsxs(C,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:t.best_score}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Best Score"})]})}),e.jsx(g,{className:"flex-1 min-w-[140px]",children:e.jsxs(C,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:t.best_evalue.toExponential(2)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Best E-Value"})]})})]}),e.jsxs(g,{children:[e.jsx(B,{className:"pb-3",children:e.jsxs(k,{className:"text-base",children:["Results ",e.jsx(E,{variant:"secondary",className:"ml-2",children:n.length})]})}),e.jsx(C,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"pb-2 pr-4 text-left font-medium text-muted-foreground",children:"Gene"}),e.jsx("th",{className:"pb-2 pr-4 text-right font-medium text-muted-foreground",children:"Hits"}),e.jsx("th",{className:"pb-2 pr-4 text-right font-medium text-muted-foreground",children:"Score"}),e.jsx("th",{className:"pb-2 pr-4 text-right font-medium text-muted-foreground",children:"E-Value"}),e.jsx("th",{className:"pb-2 pr-4 text-right font-medium text-muted-foreground",children:"Align Len"}),e.jsx("th",{className:"pb-2 pr-4 text-right font-medium text-muted-foreground",children:"Start"}),e.jsx("th",{className:"pb-2 text-right font-medium text-muted-foreground",children:"End"})]})}),e.jsx("tbody",{children:n.map((s,r)=>e.jsxs("tr",{className:"border-b last:border-0 hover:bg-muted/50",children:[e.jsx("td",{className:"py-2 pr-4",children:e.jsx("button",{className:"font-medium text-primary hover:underline",onClick:()=>a(`/?gene=${s.gene_symbol}`),children:s.gene_symbol})}),e.jsx("td",{className:"py-2 pr-4 text-right tabular-nums",children:s.num_hits}),e.jsx("td",{className:"py-2 pr-4 text-right tabular-nums",children:s.best_score}),e.jsx("td",{className:"py-2 pr-4 text-right tabular-nums",children:s.best_evalue.toExponential(2)}),e.jsx("td",{className:"py-2 pr-4 text-right tabular-nums",children:s.align_length}),e.jsx("td",{className:"py-2 pr-4 text-right tabular-nums",children:s.sbjct_start.toLocaleString()}),e.jsx("td",{className:"py-2 text-right tabular-nums",children:s.sbjct_end.toLocaleString()})]},r))})]})})})]})]})}const F=[{gene_symbol:"SAMD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"ACBD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"SAMD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"ACBD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"SAMD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"ACBD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"SAMD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"ACBD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"SAMD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"ACBD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3},{gene_symbol:"ACBD11",num_hits:42,best_score:1020,best_evalue:186617e-46,align_length:5e3,sbjct_start:2e3,sbjct_end:5e3}],z={matches:F},S="https://blast.ncbi.nlm.nih.gov/blast/Blast.cgi",$=5e3,V=18e4;async function Y(n){const t=new URLSearchParams({CMD:"Put",PROGRAM:"blastn",DATABASE:"nt",QUERY:n}),a=await fetch(S,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t.toString()});if(!a.ok)throw new Error(`NCBI BLAST submit failed: ${a.status}`);const r=(await a.text()).match(/RID\s*=\s*(\S+)/);if(!r)throw new Error("Could not parse RID from NCBI response");return r[1]}async function Z(n){const t=Date.now();for(;Date.now()-t<V;){await new Promise(l=>setTimeout(l,$));const a=`${S}?CMD=Get&FORMAT_OBJECT=SearchInfo&RID=${n}`,r=await(await fetch(a)).text();if(r.includes("Status=READY"))return;if(r.includes("Status=FAILED"))throw new Error("NCBI BLAST job failed");if(r.includes("Status=UNKNOWN"))throw new Error("NCBI BLAST RID expired or unknown")}throw new Error("NCBI BLAST timed out")}async function J(n){var T,d,b,_,A,h,y,p,f;const t=`${S}?CMD=Get&FORMAT_TYPE=JSON2_S&RID=${n}`,a=await fetch(t);if(!a.ok)throw new Error(`NCBI BLAST results fetch failed: ${a.status}`);const s=await a.json(),r=((A=(_=(b=(d=(T=s==null?void 0:s.BlastOutput2)==null?void 0:T[0])==null?void 0:d.report)==null?void 0:b.results)==null?void 0:_.search)==null?void 0:A.hits)??[],l=new Map;for(const u of r){const v=(((y=(h=u.description)==null?void 0:h[0])==null?void 0:y.title)??"").match(/\(([A-Z][A-Z0-9]{1,10})\)/),w=(v==null?void 0:v[1])??((f=(p=u.description)==null?void 0:p[0])==null?void 0:f.accession)??"Unknown";for(const o of u.hsps){const m=l.get(w);m?(m.num_hits+=1,o.bit_score>m.best_score&&(m.best_score=o.bit_score),o.evalue<m.best_evalue&&(m.best_evalue=o.evalue),o.align_len>m.align_length&&(m.align_length=o.align_len)):l.set(w,{gene_symbol:w,num_hits:1,best_score:o.bit_score,best_evalue:o.evalue,align_length:o.align_len,sbjct_start:o.hit_from,sbjct_end:o.hit_to})}}const i=Array.from(l.values()).sort((u,j)=>j.best_score-u.best_score),c=i.length>0?{total_hits:i.reduce((u,j)=>u+j.num_hits,0),best_score:i[0].best_score,best_evalue:i[0].best_evalue,best_gene_symbol:i[0].gene_symbol,longest_alignment:Math.max(...i.map(u=>u.align_length))}:void 0;return{matches:i,metadata:c}}async function Q(n){try{const t=await Y(n);return await Z(t),await J(t)}catch(t){return console.warn("NCBI BLAST unavailable, using mock data:",t.message),await new Promise(a=>setTimeout(a,500)),z}}function W(){const[n,t]=x.useState(""),[a,s]=x.useState([]),[r,l]=x.useState(null),[i,c]=x.useState(!1),[T,d]=x.useState(null),b=x.useCallback(async A=>{if(A.trim()){c(!0),d(null);try{const h=await Q(A);s(h.matches),l(h.metadata??null)}catch{d("BLAST search failed. Please try again."),s([]),l(null)}finally{c(!1)}}},[]),_=x.useCallback(()=>{t(""),s([]),l(null),d(null)},[]);return{sequence:n,setSequence:t,matches:a,metadata:r,isLoading:i,error:T,runSearch:b,clear:_}}function K(){const{sequence:n,setSequence:t,matches:a,metadata:s,isLoading:r,error:l,runSearch:i,clear:c}=W();return e.jsxs("div",{className:"mx-auto max-w-4xl space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Sequence Analyzer"}),e.jsx("p",{className:"text-muted-foreground",children:"Submit a DNA sequence to run a BLAST search against the human genome reference database."})]}),e.jsxs(g,{children:[e.jsxs(B,{children:[e.jsx(k,{className:"text-base",children:"BLAST Search"}),e.jsx(L,{children:"Paste a DNA sequence or upload a FASTA file to find matching genes."})]}),e.jsx(C,{children:e.jsx(H,{sequence:n,onSequenceChange:t,onRun:()=>i(n),onClear:c,isLoading:r})})]}),l&&e.jsx("div",{className:"rounded-md border border-destructive/50 bg-destructive/10 p-4 text-sm text-destructive",children:l}),e.jsx(U,{matches:a,metadata:s})]})}export{K as AnalyzerPage};
